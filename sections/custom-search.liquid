<div class="flex items-center space-x-2 max-w-md" {{ section.settings.container_classes }}>
  <form action="{{ routes.search_url }}" method="get" role="search" class="flex items-center w-full">
    {% assign types_array = search.types | default: section.settings.default_type | split: ',' %}
    <select
      name="type"
      class="px-3 py-2 border border-gray-300 rounded-l-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 {{ section.settings.select_classes }}"
    >
      <option value="">All</option>
      {% for option in section.settings.search_options %}
        <option
          value="{{ option.value }}"
          {% if types_array contains option.value %}
            selected
          {% endif %}
        >
          {{ option.label }}
        </option>
      {% endfor %}
    </select>

    <input
      type="search"
      name="q"
      placeholder="{{ section.settings.placeholder | default: 'Search for products...' }}"
      value="{{ search.terms | escape }}"
      class="flex-1 px-4 py-2 border border-gray-300 rounded-r-none focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm {{ section.settings.input_classes }}"
    >
    <button type="submit" class="p-3 bg-gray-200 hover:bg-gray-300 rounded-r-lg border border-gray-300">
      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
    </button>
    <input type="hidden" name="options[prefix]" value="last">
  </form>
</div>

{% schema %}
{
  "name": "Custom Search Bar",
  "tag": "section",
  "class": "section-custom-search",
  "settings": [
    {
      "type": "select",
      "id": "default_type",
      "label": "Default Filter",
      "options": [
        { "value": "", "label": "All" },
        { "value": "product", "label": "Products" },
        { "value": "article", "label": "Articles" },
        { "value": "page", "label": "Pages" }
      ],
      "default": ""
    },
    {
      "type": "text",
      "id": "placeholder",
      "label": "Search Placeholder",
      "default": "<Search for products...>"
    }
  ]
}
{% endschema %}
